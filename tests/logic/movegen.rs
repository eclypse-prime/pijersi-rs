use pijersi_rs::logic::{
    actions::{Action, ActionTrait, Actions},
    movegen::{available_piece_actions, available_player_actions},
};

use crate::TEST_CELLS;

const TEST_AVAILABLE_PLAYER_ACTIONS: &[Action] = &[
    1769248, 1253664, 1384736, 1712416, 1777952, 2105632, 2170912, 2107168, 2564128, 1769249,
    1834785, 1318945, 1712161, 2170913, 2105633, 1319457, 1450529, 1778209, 1843745, 2171425,
    2236705, 1779489, 2172705, 2564385, 1714209, 2172961, 2629921, 1834786, 1900322, 1253666,
    1384738, 1712418, 1777954, 2236706, 2171426, 1845282, 2238498, 2630178, 1780002, 2238754,
    2695714, 922915, 988451, 1316131, 1447203, 1774883, 1840419, 1441571, 1054499, 1120035,
    1447715, 1906467, 1972003, 1572643, 1383459, 1448995, 1776675, 1907747, 2300963, 1900323,
    1844003, 1449251, 1514787, 1842467, 1973539, 2301219, 1965859, 1909539, 1965860, 2031396,
    1516836, 1647908, 1975588, 2041124, 2368804, 2893092, 2434084, 1976868, 2370084, 2761764,
    1911588, 2370340, 2894628, 2827300, 2031397, 2096933, 1451045, 1909797, 1975333, 2434085,
    2368805, 2042661, 2435877, 2894629, 2827557, 2948901, 1120294, 1185830, 1513510, 1644582,
    1972262, 2037798, 1638182, 1580838, 1646374, 1974054, 2432806, 2498342, 2096934, 2041382,
    1516838, 1647910, 1975590, 2041126, 2893094, 2434598, 2436134, 2829350, 2501670, 2948902,
    2893350, 1318951, 1712167, 2564135, 2107175, 1253671, 1384743, 1712423, 1777959, 2564391,
    2172711, 2566183, 2631463, 1253672, 1384744, 1712424, 1777960, 2629928, 2172968, 1319464,
    1450536, 1778216, 1843752, 2630184, 2238504, 2631464, 2566184, 2631976, 2697256, 1319465,
    1450537, 1778217, 1843753, 2695721, 2238761, 2697257, 2631977, 2697769, 2763049, 1451050,
    1909802, 1975338, 2761770, 2370090, 2763050, 2697770, 2763562, 2894634, 2828842, 1451051,
    1909803, 1975339, 2827307, 2370347, 1516843, 1647915, 1975595, 2041131, 2827563, 2893099,
    2435883, 2894379, 2828843, 2763563, 2948907,
];

const TEST_AVAILABLE_PIECE_ACTIONS: &[Action] = &[
    1318951, 1712167, 2564135, 2107175, 1253671, 1384743, 1712423, 1777959, 2564391, 2172711,
    2566183, 2631463,
];

#[test]
fn test_concatenate_action() {
    assert_eq!(Action::from_indices(39, 32, 26), 1712167);
}

#[test]
fn test_half_action() {
    assert_eq!(8231.add_last_index(26), 39 | 1712167);
}

#[test]
fn test_available_player_actions() {
    assert_eq!(
        available_player_actions(&TEST_CELLS, 0u8),
        Actions::from(TEST_AVAILABLE_PLAYER_ACTIONS)
    )
}

#[test]
fn test_available_piece_actions() {
    let mut player_actions: Actions = Actions::default();
    available_piece_actions(&TEST_CELLS, 39, &mut player_actions);
    assert_eq!(player_actions, Actions::from(TEST_AVAILABLE_PIECE_ACTIONS));
}
